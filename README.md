# Dewatermarking for LLM-Generated Text

A Python project for studying and removing watermarks from AI-generated text. This project provides tools and methods to analyze, detect, and potentially remove watermarks that are embedded in text generated by Large Language Models (LLMs).

## Overview

This project focuses on the analysis and manipulation of watermarking techniques used in LLM-generated text. It includes components for:
- Detecting watermarks in text using various detection methods
- Evaluating watermark strength and effectiveness
- Implementing text rephrasing strategies to study watermark robustness
- Generating watermarked text for experimental purposes

## Project Structure

```
dewatermarking/
├── experiments/         # Experimental scripts
├── dewatermarking/     # Core package modules
│   ├── detect.py       # Watermark detection implementations
│   ├── evaluate.py     # Evaluation metrics and tools
│   ├── generate.py     # Text generation utilities
│   ├── rephrase.py     # Text rephrasing implementations
│   └── pipeline.py     # End-to-end processing pipelines
└── pyproject.toml      # Project dependencies and metadata
```

## Installation

1. Clone the repository:
```bash
git clone <repository-url>
cd dewatermarking
```

2. Install the package and its dependencies:
```bash
pip install -e .
```

## Requirements

The project requires Python >=3.12 and the following main dependencies:
- torch
- transformers
- sentence-transformers
- numpy
- pandas
- scikit-learn
- peft
- tqdm
- minio

All dependencies are listed in `pyproject.toml`.

## Usage

The package provides several modules for different aspects of watermark analysis:

### Detection
```python
from dewatermarking.detect import detect_watermark

# Detect watermarks in text
results = detect_watermark(text, model="your-model-name")
```

### Evaluation
```python
from dewatermarking.evaluate import evaluate_watermark

# Evaluate watermark effectiveness
metrics = evaluate_watermark(original_text, modified_text)
```

### Text Generation
```python
from dewatermarking.generate import main

# Generate watermarked text
watermarked_text = main(prompt, watermark_params={})
```

### Rephrasing
```python
from dewatermarking.rephrase import rephrase_text

# Rephrase text while attempting to preserve meaning
rephrased_text = rephrase_text(original_text)
```

## Experiments

The `experiments/` directory contains various scripts and notebooks for running experiments:
- Watermark detection analysis
- Rephrasing effectiveness studies
- Generation parameter optimization
- Evaluation metrics computation

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the Apache License 2.0 - see the LICENSE file for details.

## Citation

If you use this code in your research, please cite:

```bibtex
@misc{dewatermarking2024,
  author = {Minrui Gui},
  title = {Dewatermarking: A Framework for Analyzing and Removing Watermarks from LLM-Generated Text},
  year = {2024},
  publisher = {GitHub},
  url = {<repository-url>}
}
```
